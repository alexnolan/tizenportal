var TizenPortal=function(){"use strict";function t(t,e,n,o,r,i,a){try{var l=t[i](a),c=l.value}catch(t){return void n(t)}l.done?e(c):Promise.resolve(c).then(o,r)}function e(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */
var t,o,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",a=r.toStringTag||"@@toStringTag";function l(e,r,i,a){var l=r&&r.prototype instanceof s?r:s,u=Object.create(l.prototype);return n(u,"_invoke",function(e,n,r){var i,a,l,s=0,u=r||[],d=!1,f={p:0,n:0,v:t,a:h,f:h.bind(t,4),d:function(e,n){return i=e,a=0,l=t,f.n=n,c}};function h(e,n){for(a=e,l=n,o=0;!d&&s&&!r&&o<u.length;o++){var r,i=u[o],h=f.p,p=i[2];e>3?(r=p===n)&&(l=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=h&&((r=e<2&&h<i[1])?(a=0,f.v=n,f.n=i[1]):h<p&&(r=e<3||i[0]>n||n>p)&&(i[4]=e,i[5]=n,f.n=p,a=0))}if(r||e>1)return c;throw d=!0,n}return function(r,u,p){if(s>1)throw TypeError("Generator is already running");for(d&&1===u&&h(u,p),a=u,l=p;(o=a<2?t:l)||!d;){i||(a?a<3?(a>1&&(f.n=-1),h(a,l)):f.n=l:f.v=l);try{if(s=2,i){if(a||(r="next"),o=i[r]){if(!(o=o.call(i,l)))throw TypeError("iterator result is not an object");if(!o.done)return o;l=o.value,a<2&&(a=0)}else 1===a&&(o=i.return)&&o.call(i),a<2&&(l=TypeError("The iterator does not provide a '"+r+"' method"),a=1);i=t}else if((o=(d=f.n<0)?l:e.call(n,f))!==c)break}catch(e){i=t,a=1,l=e}finally{s=1}}return{value:o,done:d}}}(e,i,a),!0),u}var c={};function s(){}function u(){}function d(){}o=Object.getPrototypeOf;var f=[][i]?o(o([][i]())):(n(o={},i,function(){return this}),o),h=d.prototype=s.prototype=Object.create(f);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,n(t,a,"GeneratorFunction")),t.prototype=Object.create(h),t}return u.prototype=d,n(h,"constructor",d),n(d,"constructor",u),u.displayName="GeneratorFunction",n(d,a,"GeneratorFunction"),n(h),n(h,a,"Generator"),n(h,i,function(){return this}),n(h,"toString",function(){return"[object Generator]"}),(e=function(){return{w:l,m:p}})()}function n(t,e,o,r){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}n=function(t,e,o,r){function a(e,o){n(t,e,function(t){return this._invoke(e,o,t)})}e?i?i(t,e,{value:o,enumerable:!r,configurable:!r,writable:!r}):t[e]=o:(a("next",0),a("throw",1),a("return",2))},n(t,e,o,r)}function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}var r="tp-configuration",i={pointerMode:!1,focusHighlight:!0,safeMode:!1,lastVisitedUrl:null,diagnosticsEnabled:!1},a=null,l=[];function c(){if(null!==a)return a;try{var t=localStorage.getItem(r);if(t)for(var e in a=JSON.parse(t),i)i.hasOwnProperty(e)&&!a.hasOwnProperty(e)&&(a[e]=i[e]);else a=Object.assign({},i)}catch(t){console.error("TizenPortal: Failed to load config:",t),a=Object.assign({},i)}return a}function s(){c()}function u(t){var e=c();return e.hasOwnProperty(t)?e[t]:void 0}function d(t,e){var n=c(),o=n[t];o!==e&&(n[t]=e,function(){if(null!==a)try{localStorage.setItem(r,JSON.stringify(a))}catch(t){console.error("TizenPortal: Failed to save config:",t),"QuotaExceededError"===t.name&&console.warn("TizenPortal: Storage quota exceeded")}}(),function(t,e,n){for(var o={key:t,value:e,oldValue:n},r=0;r<l.length;r++)try{l[r](o)}catch(t){console.error("TizenPortal: Config change listener error:",t)}}(t,e,o))}var f=[];function h(){return f=[],"function"!=typeof window.DOMRect&&(window.DOMRect=function(t,e,n,o){this.x=t||0,this.y=e||0,this.width=n||0,this.height=o||0,this.top=this.y,this.left=this.x,this.bottom=this.y+this.height,this.right=this.x+this.width},window.DOMRect.prototype.toJSON=function(){return{x:this.x,y:this.y,width:this.width,height:this.height,top:this.top,left:this.left,bottom:this.bottom,right:this.right}},window.DOMRect.fromRect=function(t){return t=t||{},new window.DOMRect(t.x,t.y,t.width,t.height)},1)&&f.push("DOMRect"),"function"!=typeof window.DOMRectReadOnly&&(window.DOMRectReadOnly=function(t,e,n,o){this.x=t||0,this.y=e||0,this.width=n||0,this.height=o||0,this.top=this.y,this.left=this.x,this.bottom=this.y+this.height,this.right=this.x+this.width},window.DOMRectReadOnly.prototype.toJSON=function(){return{x:this.x,y:this.y,width:this.width,height:this.height,top:this.top,left:this.left,bottom:this.bottom,right:this.right}},window.DOMRectReadOnly.fromRect=function(t){return t=t||{},new window.DOMRectReadOnly(t.x,t.y,t.width,t.height)},1)&&f.push("DOMRectReadOnly"),!Element.prototype.matches&&(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(t){for(var e=(this.document||this.ownerDocument).querySelectorAll(t),n=e.length;--n>=0&&e.item(n)!==this;);return n>-1},1)&&f.push("Element.matches"),!Element.prototype.closest&&(Element.prototype.closest=function(t){for(var e=this;e&&1===e.nodeType;){if(e.matches(t))return e;e=e.parentElement||e.parentNode}return null},1)&&f.push("Element.closest"),!Array.prototype.includes&&(Array.prototype.includes=function(t,e){if(null==this)throw new TypeError('"this" is null or not defined');var n=Object(this),o=n.length>>>0;if(0===o)return!1;for(var r=0|e,i=Math.max(r>=0?r:o-Math.abs(r),0);i<o;){if(n[i]===t)return!0;i++}return!1},1)&&f.push("Array.includes"),!Object.entries&&(Object.entries=function(t){for(var e=Object.keys(t),n=e.length,o=new Array(n);n--;)o[n]=[e[n],t[e[n]]];return o},1)&&f.push("Object.entries"),!Object.values&&(Object.values=function(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(t[n]);return e},1)&&f.push("Object.values"),!String.prototype.startsWith&&(String.prototype.startsWith=function(t,e){return e=e||0,this.substr(e,t.length)===t},1)&&f.push("String.startsWith"),!String.prototype.endsWith&&(String.prototype.endsWith=function(t,e){return(void 0===e||e>this.length)&&(e=this.length),this.substring(e-t.length,e)===t},1)&&f.push("String.endsWith"),f}var p={LEFT:37,UP:38,RIGHT:39,DOWN:40,ENTER:13,EXIT:10182,RED:403,GREEN:404,YELLOW:405,BLUE:406,PLAY:415,PAUSE:19,PLAY_PAUSE:10252,STOP:413,REWIND:412,FAST_FORWARD:417,TRACK_PREVIOUS:10232,TRACK_NEXT:10233,VOLUME_UP:447,VOLUME_DOWN:448,MUTE:449,CHANNEL_UP:427,CHANNEL_DOWN:428,NUM_0:48,NUM_1:49,NUM_2:50,NUM_3:51,NUM_4:52,NUM_5:53,NUM_6:54,NUM_7:55,NUM_8:56,NUM_9:57,IME_DONE:65376,IME_CANCEL:65385,INFO:457,GUIDE:458,SOURCE:10072,MENU:10133,TOOLS:10135},g={short:"addressbar",long:"reload"},m={short:"pointerMode",long:"focusHighlight"},y={short:"bundleMenu",long:"cycleBundle"},w={short:"diagnostics",long:"safeMode"};function v(t){return t===p.RED||t===p.GREEN||t===p.YELLOW||t===p.BLUE}var E={},b=!1,T=[];function P(){document.addEventListener("keydown",O,!0),document.addEventListener("keyup",z,!0),console.log("TizenPortal: Input handler initialized")}function O(t){var e=t.keyCode;t.repeat||(E[e]=Date.now());var n=function(t){for(var e in p)if(p.hasOwnProperty(e)&&p[e]===t)return e;return null}(e);if(n&&console.log("TizenPortal: Key down - "+n+" ("+e+")"),e!==p.IME_DONE&&e!==p.IME_CANCEL){if(!b||v(e)){for(var o=0;o<T.length;o++)try{if(!0===T[o](t))return t.preventDefault(),void t.stopPropagation()}catch(t){console.error("TizenPortal: Custom key handler error:",t)}if(v(e))return t.preventDefault(),void t.stopPropagation();p.ENTER}}else b=!1}function z(t){var e=t.keyCode,n=E[e]||Date.now(),o=Date.now()-n>=500;if(delete E[e],v(e))return t.preventDefault(),t.stopPropagation(),void function(t,e){var n=null;switch(t){case p.RED:n=e?g.long:g.short;break;case p.GREEN:n=e?m.long:m.short;break;case p.YELLOW:n=e?y.long:y.short;break;case p.BLUE:n=e?w.long:w.short}n&&(console.log("TizenPortal: Color button action - "+n),function(t){switch(t){case"addressbar":console.log("TizenPortal: Address bar (not implemented)"),window.TizenPortal&&window.TizenPortal.showToast("Address bar - coming soon");break;case"reload":var e=document.getElementById("tp-iframe");e&&e.contentWindow&&(e.contentWindow.location.reload(),window.TizenPortal&&window.TizenPortal.showToast("Reloading..."));break;case"pointerMode":var n=u("pointerMode")||!1;d("pointerMode",!n),window.TizenPortal&&window.TizenPortal.showToast("Mouse mode: "+(n?"OFF":"ON"));break;case"focusHighlight":var o=u("focusHighlight");void 0===o&&(o=!0),d("focusHighlight",!o),window.TizenPortal&&window.TizenPortal.showToast("Focus highlight: "+(o?"OFF":"ON"));break;case"bundleMenu":console.log("TizenPortal: Bundle menu (not implemented)"),window.TizenPortal&&window.TizenPortal.showToast("Bundle menu - coming soon");break;case"cycleBundle":console.log("TizenPortal: Cycle bundle (not implemented)"),window.TizenPortal&&window.TizenPortal.showToast("Cycle bundle - coming soon");break;case"diagnostics":console.log("TizenPortal: Diagnostics (not implemented)"),window.TizenPortal&&window.TizenPortal.showToast("Diagnostics - coming soon");break;case"safeMode":d("safeMode",!0),window.TizenPortal&&window.TizenPortal.showToast("Entering safe mode..."),setTimeout(function(){window.location.reload()},500);break;default:console.warn("TizenPortal: Unknown color action:",t)}}(n))}(e,o)}var M="tp_apps",S=null;function N(){for(var t="0123456789abcdef",e=[8,4,4,4,12],n=[],o=0;o<e.length;o++){for(var r="",i=0;i<e[o];i++)r+=t.charAt(Math.floor(16*Math.random()));n.push(r)}return n.join("-")}function A(){if(null!==S)return S;try{var t=localStorage.getItem(M);t?(S=JSON.parse(t),Array.isArray(S)||(S=[])):S=[]}catch(t){console.error("TizenPortal: Failed to load cards:",t),S=[]}return S}function C(){return A().slice()}function L(t){var e=A(),n={id:N(),name:t.name||"Untitled",url:t.url||"",bundle:t.bundle||"default",userAgent:t.userAgent||"tizen",icon:null,order:e.length,createdAt:Date.now(),updatedAt:Date.now()};return e.push(n),S=e,function(){if(null!==S)try{localStorage.setItem(M,JSON.stringify(S))}catch(t){console.error("TizenPortal: Failed to save cards:",t),"QuotaExceededError"===t.name&&console.warn("TizenPortal: Storage quota exceeded")}}(),n}var R=null,D=null,x=0;function U(){R=document.getElementById("tp-portal"),D=document.getElementById("tp-grid"),R&&D?(k(),F(0)):console.error("TizenPortal: Portal elements not found")}function k(){if(D){D.innerHTML="";for(var t=C(),e=0;e<t.length;e++){var n=_(t[e],e);D.appendChild(n)}var o=function(t){var e=document.createElement("div");e.className="tp-card tp-card-add",e.setAttribute("tabindex","0"),e.setAttribute("data-index",t);var n=document.createElement("div");n.className="tp-card-icon",n.textContent="+",e.appendChild(n);var o=document.createElement("div");return o.className="tp-card-name",o.textContent="Add Site",e.appendChild(o),e.addEventListener("click",function(){B()}),e.addEventListener("keydown",function(t){13===t.keyCode&&(t.preventDefault(),B())}),e.addEventListener("focus",function(){x=t}),e}(t.length);D.appendChild(o)}}function _(t,e){var n=document.createElement("div");n.className="tp-card",n.setAttribute("tabindex","0"),n.setAttribute("data-card-id",t.id),n.setAttribute("data-index",e);var o=document.createElement("div");if(o.className="tp-card-icon",t.icon){var r=document.createElement("img");r.src=t.icon,r.alt=t.name,r.style.width="100%",r.style.height="100%",r.style.objectFit="cover",r.style.borderRadius="8px",r.onerror=function(){this.style.display="none",o.textContent=I(t.name)},o.appendChild(r)}else o.textContent=I(t.name);n.appendChild(o);var i=document.createElement("div");return i.className="tp-card-name",i.textContent=t.name||"Untitled",n.appendChild(i),n.addEventListener("click",function(){j(t)}),n.addEventListener("keydown",function(e){13===e.keyCode&&(e.preventDefault(),j(t))}),n.addEventListener("focus",function(){x=e}),n}function I(t){return t?t.charAt(0).toUpperCase():"?"}function j(t){console.log("TizenPortal: Launching card:",t.name,t.url),window.TizenPortal&&window.TizenPortal.loadSite&&window.TizenPortal.loadSite(t)}function B(){console.log("TizenPortal: Add card dialog");var t=prompt("Site name:");if(t){var e=prompt("Site URL:");if(e){-1===e.indexOf("://")&&(e="http://"+e);var n=L({name:t,url:e,bundle:"default",userAgent:"tizen"});console.log("TizenPortal: Added card:",n),window.TizenPortal&&window.TizenPortal.showToast("Added: "+t),W()}}}function F(t){var e=D.querySelectorAll(".tp-card");t>=0&&t<e.length&&(e[t].focus(),x=t)}function W(){k(),F(Math.min(x,C().length))}var G=[],H={log:console.log,warn:console.warn,error:console.error,info:console.info},J=[];function q(){console.log=function(){V("log",arguments),H.log.apply(console,arguments)},console.warn=function(){V("warn",arguments),H.warn.apply(console,arguments)},console.error=function(){V("error",arguments),H.error.apply(console,arguments)},console.info=function(){V("info",arguments),H.info.apply(console,arguments)},window.onerror=function(t,e,n,o,r){V("error",["Uncaught: "+t,"at",e+":"+n+":"+o])},window.onunhandledrejection=function(t){V("error",["Unhandled Promise Rejection:",t.reason])}}function V(t,e){var n=function(t){for(var e=[],n=0;n<t.length;n++){var r=t[n];if(null===r)e.push("null");else if(void 0===r)e.push("undefined");else if("object"===o(r))try{e.push(JSON.stringify(r))}catch(t){e.push("[Object]")}else e.push(String(r))}return e.join(" ")}(e),r={timestamp:Date.now(),level:t,message:n};G.push(r),G.length>500&&(G=G.slice(-500));for(var i=0;i<J.length;i++)try{J[i](r)}catch(t){H.error("Log listener error:",t)}}function Y(){for(var t=["TizenPortal:"],e=0;e<arguments.length;e++)t.push(arguments[e]);console.log.apply(console,t)}function K(){for(var t=["TizenPortal:"],e=0;e<arguments.length;e++)t.push(arguments[e]);console.warn.apply(console,t)}function Q(){for(var t=["TizenPortal:"],e=0;e<arguments.length;e++)t.push(arguments[e]);console.error.apply(console,t)}var X="0100",Z={initialized:!1,currentCard:null,currentBundle:null,iframeActive:!1};function $(){return tt.apply(this,arguments)}function tt(){var n;return n=e().m(function t(){var n,o;return e().w(function(t){for(;;)switch(t.p=t.n){case 0:if(!Z.initialized){t.n=1;break}return K("TizenPortal already initialized"),t.a(2);case 1:return Y("TizenPortal 0100 initializing..."),t.p=2,t.n=3,h();case 3:Y("Polyfills loaded: "+((n=t.v).length>0?n.join(", "):"none needed")),s(),Y("Configuration initialized"),q(),Y("Diagnostics initialized"),P(),Y("Input handler initialized"),U(),Y("Portal UI initialized"),Z.initialized=!0,Y("TizenPortal 0100 ready"),et("TizenPortal "+X),t.n=5;break;case 4:t.p=4,Q("Initialization failed: "+(o=t.v).message),console.error(o);case 5:return t.a(2)}},t,null,[[2,4]])}),tt=function(){var e=this,o=arguments;return new Promise(function(r,i){var a=n.apply(e,o);function l(e){t(a,r,i,l,c,"next",e)}function c(e){t(a,r,i,l,c,"throw",e)}l(void 0)})},tt.apply(this,arguments)}function et(t,e){e=e||3e3;var n=document.getElementById("tp-toast");n&&(n.textContent=t,n.classList.add("visible"),setTimeout(function(){n.classList.remove("visible")},e))}function nt(t){var e=document.getElementById("tp-loading"),n=document.getElementById("tp-loading-text");e&&(n&&t&&(n.textContent=t),e.classList.add("active"))}function ot(){var t=document.getElementById("tp-loading");t&&t.classList.remove("active")}var rt={version:X,log:Y,warn:K,error:Q,config:{read:u,write:d,onChange:function(t){return"function"!=typeof t?(console.warn("TizenPortal: configOnChange requires a function"),function(){}):(l.push(t),function(){var e=l.indexOf(t);-1!==e&&l.splice(e,1)})}},keys:p,input:{isPointerMode:function(){return u("pointerMode")||!1},isIMEActive:function(){return!1}},polyfills:{has:function(t){return-1!==f.indexOf(t)},loaded:function(){return f.slice()}},loadSite:function(t){if(t&&t.url){Y("Loading site: "+t.url),nt("Loading "+(t.name||t.url)+"..."),Z.currentCard=t;var e=document.getElementById("tp-iframe-container");if(!e)return Q("Iframe container not found"),void ot();e.innerHTML="";var n=document.createElement("iframe");n.id="tp-iframe",n.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups"),n.onload=function(){Y("Site loaded: "+t.url),ot(),Z.iframeActive=!0},n.onerror=function(e){Q("Failed to load site: "+t.url),ot(),et("Failed to load site")},n.src=t.url,e.appendChild(n),R&&(R.style.display="none"),e.style.display="block"}else Q("Cannot load site: invalid card")},closeSite:function(){Y("Closing site");var t=document.getElementById("tp-iframe-container");t&&(t.innerHTML="",t.style.display="none"),Z.currentCard=null,Z.currentBundle=null,Z.iframeActive=!1,R&&(R.style.display="flex",F(x)),W()},showToast:et,showLoading:nt,hideLoading:ot,getState:function(){return{initialized:Z.initialized,currentCard:Z.currentCard,currentBundle:Z.currentBundle,iframeActive:Z.iframeActive}},_internal:{state:Z,init:$}};return window.TizenPortal=rt,"loading"===document.readyState?document.addEventListener("DOMContentLoaded",$):$(),rt}();
